# XanoScript CLI Setup Guide

## Automatic Installation with `xs-setup`

The XanoScript CLI now includes an **automatic setup command** that installs the Claude Code skill and command for you!

## Quick Start

```bash
# 1. Install the CLI globally (one time)
npm link

# 2. Go to your XanoScript project
cd /path/to/your/xanoscript-project

# 3. Run automatic setup
xs-setup

# Done! Skill and command are now available in Claude Code
```

## Setup Options

### Option 1: Setup in Current Project (Default)

```bash
cd /path/to/your/project
xs-setup
```

**What it does:**
- Copies skill to `.claude/skills/xanoscript-lint/`
- Copies command to `.claude/commands/xs-lint.md`
- Enables automatic validation in Claude Code

### Option 2: Setup with Symlinks (Recommended for Development)

```bash
xs-setup --symlink
```

**Benefits:**
- Links to CLI installation instead of copying
- Updates automatically when CLI is updated
- Saves disk space

**Perfect for:**
- Developers working on multiple projects
- When you want instant CLI updates across all projects

### Option 3: Setup Globally (All Projects)

```bash
xs-setup --global
```

**What it does:**
- Installs to `~/.claude/` directory
- Makes skill/command available to ALL projects
- One-time setup for your entire machine

**Perfect for:**
- Users who want automatic validation in every project
- Quick setup without per-project configuration

### Option 4: Setup in Specific Project

```bash
xs-setup /path/to/specific/project
```

Installs to the specified project directory.

### Option 5: Install Only Skill or Command

```bash
# Only automatic validation (skill)
xs-setup --skill

# Only manual validation (command)
xs-setup --command
```

## After Setup

Once setup is complete, you have:

### 1. Automatic Validation (Skill)

Claude Code automatically validates `.xs` files:

```
You: "Create a new endpoint for users"

Claude:
- Creates users.xs
- ðŸ”„ Automatically validates
- Reports: "âœ… Created users.xs - No errors!"
```

### 2. Manual Validation (Command)

Trigger validation on demand:

```
/xs-lint
```

### 3. CLI Validation

Run from terminal:

```bash
xs-lint
xs-lint src/**/*.xs
xs-lint --json

# Automation-friendly (stable signature)
printf "%s\n" src/api/users.xs src/api/posts.xs | xs-lint --json --stdin
```

## Verification

Check that setup worked:

```bash
# Check if files were created
ls -la .claude/skills/xanoscript-lint/
ls -la .claude/commands/xs-lint.md

# Try the command in Claude Code
# Type: /xs-lint

# Try automatic validation
# Tell Claude: "Create a test endpoint"
```

## Update / Reinstall

To update or reinstall:

```bash
# Just run setup again - it will replace existing files
xs-setup

# Or with symlinks to get latest version
xs-setup --symlink
```

## Uninstall

To remove Claude Code integration:

```bash
# Remove from project
rm -rf .claude/skills/xanoscript-lint
rm .claude/commands/xs-lint.md

# Or remove globally
rm -rf ~/.claude/skills/xanoscript-lint
rm ~/.claude/commands/xs-lint.md

# CLI remains available for terminal use
```

## Common Scenarios

### Scenario 1: New to XanoScript

```bash
# Install CLI
npm link

# Setup in your first project
cd ~/xanoscript-projects/my-app
xs-setup

# Start coding!
# Claude will automatically validate your .xs files
```

### Scenario 2: Multiple Projects

```bash
# Install CLI once
npm link

# Option A: Setup globally (all projects get it)
xs-setup --global

# Option B: Setup each project individually
xs-setup ~/project1
xs-setup ~/project2
xs-setup ~/project3
```

### Scenario 3: Team Development

```bash
# Each team member:

# 1. Clone the CLI repo
git clone <xano-lsp-cli-repo>
cd xano-lsp-cli
npm install
npm link

# 2. Setup their project with symlinks
cd /path/to/team/project
xs-setup --symlink

# Now everyone has automatic validation!
# CLI updates are shared via git
```

### Scenario 4: CI/CD Pipeline

```bash
# In your CI/CD configuration:

# Install CLI
npm install -g xanoscript-lint

# Validate (no need for skill/command in CI)
xs-lint --json

# Fail build if errors
xs-lint || exit 1
```

## Troubleshooting

### "xs-setup: command not found"

You need to link the CLI first:

```bash
cd /path/to/xano-lsp-cli
npm link
```

Or use the full path:

```bash
node /path/to/xano-lsp-cli/bin/xs-setup.js
```

### "Setup failed: Permission denied"

Try with sudo (Linux/Mac):

```bash
sudo xs-setup --global
```

Or setup in project instead of globally:

```bash
xs-setup  # No --global flag
```

### Symlinks not working

Symlinks require:
- **macOS/Linux**: Should work by default
- **Windows**: May need administrator privileges

If symlinks fail, use regular copy:

```bash
xs-setup  # Without --symlink flag
```

### Skill/Command not appearing in Claude Code

1. Check files were created:
   ```bash
   ls .claude/skills/xanoscript-lint/
   ls .claude/commands/
   ```

2. Restart Claude Code

3. Make sure you're in the right directory

4. Try re-running setup:
   ```bash
   xs-setup --symlink
   ```

## What Gets Installed

### Skill Directory Structure
```
.claude/skills/xanoscript-lint/
â”œâ”€â”€ SKILL.md                              # Main skill definition
â”œâ”€â”€ AUTOMATIC_VALIDATION_EXAMPLES.md      # Usage examples
â””â”€â”€ reference/
    â”œâ”€â”€ PATTERNS.md                       # XanoScript syntax patterns
    â””â”€â”€ XANOSCRIPT_LSP.md                # LSP documentation
```

### Command File
```
.claude/commands/xs-lint.md               # Slash command definition
```

## Advanced Usage

### Custom Setup Location

```bash
# Install to custom .claude location
CLAUDE_DIR=/custom/path xs-setup
```

### Selective Installation

```bash
# Only install skill (automatic validation)
xs-setup --skill --symlink

# Only install command (manual validation)
xs-setup --command
```

### Check What's Installed

```bash
# If using symlinks, check targets
ls -la .claude/skills/xanoscript-lint  # Should show -> link
ls -la .claude/commands/xs-lint.md      # Should show -> link

# If copied, check file sizes
du -sh .claude/skills/xanoscript-lint
```

## Next Steps

After setup:

1. **Read the documentation:**
   - [AUTOMATIC_VALIDATION.md](AUTOMATIC_VALIDATION.md) - How automatic validation works
   - [SKILL_VS_COMMAND.md](SKILL_VS_COMMAND.md) - Skill vs Command comparison
   - [TESTING.md](TESTING.md) - Testing guide

2. **Try it out:**
   - Create a new `.xs` file in Claude Code
   - Watch automatic validation in action
   - Try the `/xs-lint` command

3. **Integrate with workflow:**
   - Add validation to CI/CD
   - Setup pre-commit hooks
   - Share with your team

## Summary

```bash
# The complete setup flow:

# 1. One-time CLI installation
npm link

# 2. Per-project setup (choose one)
xs-setup                    # Copy to current project
xs-setup --symlink          # Link to current project (auto-updates)
xs-setup --global           # Available in all projects

# 3. Start coding!
# Automatic validation is now active in Claude Code
```

That's it! Your XanoScript project now has automatic validation built in.
